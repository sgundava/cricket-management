# Cricket Match Engine Probability Parameters
# Calibrated from IPL historical data (to be updated with real analysis)
#
# These parameters can be A/B tested and tuned without code changes.
# All probabilities should sum to 1.0 within their group.

# ============================================
# BASE OUTCOME PROBABILITIES
# ============================================
# Calibrated from IPL data (278K balls, 1169 matches, 2009-2025)
# Wicket at 5.1% = ~6 wickets per 120 balls (realistic T20)
base_outcomes:
  dot: 0.326
  single: 0.382
  two: 0.065
  three: 0.003
  four: 0.119
  six: 0.053
  wicket: 0.051

# ============================================
# PHASE MODIFIERS
# ============================================
# Calibrated from IPL data - multipliers applied based on match phase
phase_modifiers:
  powerplay:
    boundary_mod: 1.08    # Slight boundary boost
    wicket_mod: 0.76      # Batters play safer in PP (surprising finding!)
    dot_mod: 1.32         # More defensive play
    run_rate_target: 7.5  # Expected run rate
  middle:
    boundary_mod: 0.85    # Consolidation phase
    wicket_mod: 0.89      # Safer batting
    dot_mod: 0.87
    run_rate_target: 7.8
  death:
    boundary_mod: 1.23    # Big hitting phase
    wicket_mod: 1.78      # High risk swings - nearly 2x wicket rate!
    dot_mod: 0.68
    run_rate_target: 9.8

# ============================================
# TACTICAL APPROACH MODIFIERS
# ============================================
# Based on batting team's tactical approach selection
tactical_modifiers:
  aggressive:
    boundary_mod: 1.25
    wicket_mod: 1.10
    dot_mod: 0.85
  balanced:
    boundary_mod: 1.00
    wicket_mod: 1.00
    dot_mod: 1.00
  cautious:
    boundary_mod: 0.75
    wicket_mod: 0.90
    dot_mod: 1.15

# ============================================
# BOWLING LENGTH MODIFIERS
# ============================================
# Based on bowler's selected length
bowling_length_modifiers:
  good-length:
    boundary_mod: 1.00
    wicket_mod: 1.00
    dot_mod: 1.00
    skill_type: accuracy
    min_skill: 0
  short:
    boundary_mod: 1.30    # Can be pulled/hooked
    wicket_mod: 1.08      # Top edge catches
    dot_mod: 0.85
    skill_type: speed
    min_skill: 65
  yorkers:
    boundary_mod: 0.70    # Hard to hit boundaries
    wicket_mod: 1.05      # LBW, bowled
    dot_mod: 1.30         # Many dots
    skill_type: accuracy
    min_skill: 70         # Need skill to execute
  full-pitched:
    boundary_mod: 1.15    # Driving options
    wicket_mod: 1.10      # Can get driven in air
    dot_mod: 0.95
    skill_type: accuracy
    min_skill: 50

# ============================================
# FIELD SETTING MODIFIERS
# ============================================
# Based on bowling team's field setting
field_setting_modifiers:
  attacking:
    boundary_mod: 1.25    # Gaps in outfield
    wicket_mod: 1.10      # More catching positions
    catch_mod: 1.15
    runout_mod: 0.90
  balanced:
    boundary_mod: 1.00
    wicket_mod: 1.00
    catch_mod: 1.00
    runout_mod: 1.00
  defensive:
    boundary_mod: 0.70    # Boundary riders
    wicket_mod: 0.90      # Fewer catchers
    catch_mod: 0.85
    runout_mod: 1.10
  death-field:
    boundary_mod: 0.60    # Long-off, long-on, deep
    wicket_mod: 0.95
    catch_mod: 1.05       # High catches
    runout_mod: 1.15

# ============================================
# BATSMAN STATE MODIFIERS
# ============================================
# Calibrated from IPL data - based on balls faced by the batter
batsman_state:
  thresholds:
    new: 6          # First 6 balls
    settling: 15    # Balls 7-15
  modifiers:
    new:
      boundary_mod: 0.78    # Getting eye in
      wicket_mod: 0.90      # Actually SAFER - playing carefully
      dot_mod: 1.30         # Many more dots
      single_mod: 0.88
    settling:
      boundary_mod: 1.12    # Opening up
      wicket_mod: 1.01
      dot_mod: 0.97
      single_mod: 0.98
    set:
      boundary_mod: 1.11    # Full confidence
      wicket_mod: 1.08      # Taking more risks
      dot_mod: 0.74         # Fewer dots
      single_mod: 1.13      # Better rotation

# ============================================
# PRESSURE/MOMENTUM MODIFIERS
# ============================================
# Context-based adjustments
pressure:
  # Recent wickets - batters consolidate
  recent_wickets:
    2:
      boundary_mod: 0.95
      dot_mod: 1.02
    3:
      boundary_mod: 0.90
      dot_mod: 1.05

  # Bowler on a roll
  bowler_on_roll:
    2_wickets:
      boundary_mod: 0.96
    3_wickets:
      boundary_mod: 0.92

  # Partnership builds confidence
  partnership:
    30_runs:
      boundary_mod: 1.04
      wicket_mod: 0.96    # Set batters safer
    50_runs:
      boundary_mod: 1.08
      wicket_mod: 0.92

  # High required rate forces risks
  required_rate:
    9_to_12:
      boundary_mod: 1.15
      wicket_mod: 1.20
    over_12:
      boundary_mod: 1.30
      wicket_mod: 1.40

# ============================================
# SKILL IMPACT
# ============================================
# How player skills affect outcomes
# Values are per 10 skill points above 60 baseline
skill_impact:
  batting:
    technique:
      boundary: 0.02
      wicket: -0.01
    power:
      six: 0.03
      four: 0.01
    timing:
      four: 0.02
      single: 0.01
    temperament:
      wicket: -0.02

  bowling:
    speed:
      wicket: 0.015
      boundary: 0.01      # Pace is double-edged
    accuracy:
      dot: 0.02
      wicket: 0.01
      boundary: -0.02
    variation:
      wicket: 0.02
      boundary: -0.01
    stamina:
      fatigue_resistance: 0.02

# ============================================
# PITCH EFFECTS
# ============================================
# Per 10 points above 50 baseline
pitch:
  pace:
    fast_bowler_wicket: 0.02
    boundary: 0.01
  spin:
    spin_bowler_wicket: 0.02
    boundary: -0.01
  bounce:
    wicket_from_short: 0.015
  deterioration:
    second_innings_spin: 0.03

# ============================================
# DISMISSAL TYPE DISTRIBUTION
# ============================================
# Calibrated from IPL data - caught dominates at 65%!
dismissals:
  base:
    caught: 0.65
    bowled: 0.17
    lbw: 0.06
    runout: 0.08
    stumped: 0.03
    hitwicket: 0.01

  # Adjustments by bowler type
  fast_bowler:
    caught: 0.68
    bowled: 0.18
    lbw: 0.08
    runout: 0.05
    stumped: 0.00
    hitwicket: 0.01

  spin_bowler:
    caught: 0.60
    bowled: 0.14
    lbw: 0.05
    runout: 0.06
    stumped: 0.14
    hitwicket: 0.01

# ============================================
# FIELDING IMPACT
# ============================================
fielding:
  baseline: 60    # Average skill level
  boundary_save:
    max_chance: 0.30    # Maximum save probability
    athleticism_weight: 0.7
    ground_weight: 0.3
  catch_conversion:
    baseline: 0.85    # 85% catch success
    skill_impact: 0.002    # Per point above baseline
  runout:
    baseline: 0.70
    throwing_impact: 0.003

# ============================================
# EXTRAS
# ============================================
# Calibrated from IPL data
extras:
  wide_chance: 0.0326     # Per ball (3.26% - higher than expected)
  noball_chance: 0.0041   # Per ball (0.41% - lower than expected)
  accuracy_impact: -0.0002    # Per accuracy point
